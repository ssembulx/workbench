<div class="users">
    <div class="content">
        <div class="user-content">
            <div style="display: inline-flex;">
                <div class="btn-dv2" [ngClass]="typeChart == 'Location chart' ? 'active-btn' : ''"
                    (click)="Options('Allocation')">
                    Summary
                </div>
                <div class="btn-dv" [ngClass]="typeChart == 'Program chart' ? 'active-btn' : ''"
                    (click)="Options('Deallocation')">
                    Add Forecast Data
                </div>
                <div class="btn-dv" [ngClass]="typeChart == 'YOY Comparison' ? 'active-btn' : ''"
                    (click)="Options('YOY Comparison')">
                    YOY Comparison
                </div>
            </div>
            <!-- Summary -->
            <div class="col-12" [hidden]="typeChart != 'Location chart'">
                <div class="content p-0 m-0" style=" width: 100%;">
                    <div class="row charts-content">

                        <!-- ******* Semi circle pie chart ******* -->
                        <div class="semi-pie-chart col-12 mb-0" #fullscreenPie>
                            <div>
                                <div class="chart-style">
                                    <div class="caption">
                                        <i class="fa fa-chart-bar fa-2x chart-icon"></i>
                                        <span class="chart-heading">Forecast Summary {{preSelectedYear}}</span>
                                    </div>
                                    <i class="fa fa-download  fa-2x chart-icon"
                                        ngbTooltip="Download Forecast Summary Data" (click)="downloadForecastSummary()"
                                        aria-hidden="true"
                                        style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 72%;cursor: pointer;"></i>
                                    <select class="form-select location_select" style="width: 120px;"
                                        aria-label="Default select example" [(ngModel)]="preSelectedYear"
                                        (change)="onItemSelected()">
                                        <option selected value="">Select Year</option>
                                        <option *ngFor="let locat of yearList" [ngValue]="locat">
                                            {{locat}}
                                        </option>
                                    </select>
                                    <!--  <i class="fa fa-download  fa-2x chart-icon" aria-hidden="true"
                                    style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 7px;cursor: pointer;"></i> -->
                                </div>
                            </div>

                            <hr class="box-hr">

                            <!-- ******* Labwise chart table view *******  -->
                            <div id="chartdiv"></div>

                        </div>
                        <!-- No data available display -->
                        <!--   <div class="no_data_block_display" *ngIf='ChartData?.length == 0'>
                        <h2 class="mt-2">No Data Available</h2>
                    </div> -->
                    </div>
                    <br />
                </div>
                <div class="content p-0 m-0" style=" width: 35%;float: left;">
                    <div class="row charts-content">

                        <!-- ******* Semi circle pie chart ******* -->
                        <div class="semi-pie-chart col-12 mt-0 mb-0" #fullscreenPie>
                            <div>
                                <div class="chart-style">
                                    <div class="caption">
                                        <i class="fa fa-chart-bar fa-2x chart-icon"></i>
                                        <span class="chart-heading">RVP Forecast {{preSelectedQuarterRVP}} (Quarterly
                                            Split)</span>
                                    </div>
                                    <i class="fa fa-download  fa-2x chart-icon"
                                        ngbTooltip="Download RVP Forecast Quarterly Split Data"
                                        (click)="downloadRvpRampQuarterly()" aria-hidden="true"
                                        style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 8%;cursor: pointer;"></i>
                                    <select class="form-select location_select" style="width: 100px;"
                                        aria-label="Default select example" [(ngModel)]="preSelectedQuarterRVP"
                                        (change)="onItemSelectedrvpQuarter()">
                                        <option selected value="">Select Year</option>
                                        <option *ngFor="let locat of yearList" [ngValue]="locat">
                                            {{locat}}
                                        </option>
                                    </select>
                                    <!--  <i class="fa fa-download  fa-2x chart-icon" aria-hidden="true"
                                    style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 7px;cursor: pointer;"></i> -->
                                </div>
                            </div>

                            <hr class="box-hr">

                            <!-- ******* Labwise chart table view *******  -->
                            <div id="chartdiv1"></div>

                        </div>
                        <!-- No data available display -->
                        <!--   <div class="no_data_block_display" *ngIf='ChartData?.length == 0'>
                        <h2 class="mt-2">No Data Available</h2>
                    </div> -->
                    </div>
                    <br />
                </div>
                <div class="content p-0 m-0" style=" width: 65%;float: left;">
                    <div class="row charts-content">

                        <!-- ******* Semi circle pie chart ******* -->
                        <div class="semi-pie-chart col-12 mt-0 mb-0" #fullscreenPie>
                            <div>
                                <div class="chart-style">
                                    <div class="caption">
                                        <i class="fa fa-chart-bar fa-2x chart-icon"></i>
                                        <span class="chart-heading">RVP Ramp Forecast {{preSelectedYearRVP}}</span>
                                    </div>
                                    <i class="fa fa-download  fa-2x chart-icon"
                                        ngbTooltip="Download RVP Ramp Forecast Data" (click)="downloadRvpYear()"
                                        aria-hidden="true"
                                        style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 55%;cursor: pointer;"></i>
                                    <select class="form-select location_select" style="width: 120px;"
                                        aria-label="Default select example" [(ngModel)]="preSelectedYearRVP"
                                        (change)="onItemSelectedrvpYear()">
                                        <option selected value="">Select Year</option>
                                        <option *ngFor="let locat of yearList" [ngValue]="locat">
                                            {{locat}}
                                        </option>
                                    </select>
                                    <!--  <i class="fa fa-download  fa-2x chart-icon" aria-hidden="true"
                                    style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 7px;cursor: pointer;"></i> -->
                                </div>
                            </div>

                            <hr class="box-hr">

                            <!-- ******* Labwise chart table view *******  -->
                            <div id="chartdiv2"></div>

                        </div>
                        <!-- No data available display -->
                        <!--   <div class="no_data_block_display" *ngIf='ChartData?.length == 0'>
                        <h2 class="mt-2">No Data Available</h2>
                    </div> -->
                    </div>
                    <br />
                </div>
                <div class="content p-0 m-0" style=" width: 100%;float:left">
                    <div class="row charts-content">

                        <!-- ******* Semi circle pie chart ******* -->
                        <div class="semi-pie-chart col-12 mb-0 mt-0" #fullscreenPie>
                            <div>
                                <div class="chart-style">
                                    <div class="caption">
                                        <i class="fa fa-table fa-2x chart-icon"></i>
                                        <span class="chart-heading">Bench & Rack Demand @ Intel & ODC
                                            {{preSelectedForecastTableSummary}}</span>
                                    </div>
                                    <i class="fa fa-download  fa-2x chart-icon"
                                        ngbTooltip="Download Bench & Rack Demand @ Intel & ODC Data"
                                        (click)="downloadForecastTableSummaryList()" aria-hidden="true"
                                        style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 62%;cursor: pointer;"></i>
                                    <select class="form-select location_select" style="width: 120px;"
                                        aria-label="Default select example"
                                        [(ngModel)]="preSelectedForecastTableSummary"
                                        (change)="onItemSelectedforecastTableSummary()">
                                        <option selected value="">Select Year</option>
                                        <option *ngFor="let locat of yearList" [ngValue]="locat">
                                            {{locat}}
                                        </option>
                                    </select>
                                    <!--  <i class="fa fa-download  fa-2x chart-icon" aria-hidden="true"
                                    style="color: #9eacb4;font-size: 22px;margin-top: -1px;margin-left: 7px;cursor: pointer;"></i> -->
                                </div>
                            </div>

                            <hr class="box-hr">

                            <!-- ******* Labwise chart table view *******  -->
                            <!-- <div id="chartdiv"></div> -->

                            <table class="table table-bordered" cellspacing=0 border=1>
                                <!-- <ng-container *ngFor="let data of forecastTableSummaryList">
                                    <tr>
                                        <td style="min-width:50px"></td>
                                        <td style="min-width:50px">{{data.category}}</td>
                                    </tr>
                                </ng-container> -->
                                <tr>
                                    <td style="min-width:50px"></td>
                                    <td style="min-width:50px;font-weight: bold;">JAN</td>
                                    <td style="min-width:50px;font-weight: bold;">FEB</td>
                                    <td style="min-width:50px;font-weight: bold;">MAR</td>
                                    <td style="min-width:50px;font-weight: bold;">APR</td>
                                    <td style="min-width:50px;font-weight: bold;">MAY</td>
                                    <td style="min-width:50px;font-weight: bold;">JUN</td>
                                    <td style="min-width:50px;font-weight: bold;">JUL</td>
                                    <td style="min-width:50px;font-weight: bold;">AUG</td>
                                    <td style="min-width:50px;font-weight: bold;">SEP</td>
                                    <td style="min-width:50px;font-weight: bold;">OCT</td>
                                    <td style="min-width:50px;font-weight: bold;">NOV</td>
                                    <td style="min-width:50px;font-weight: bold;">DEC</td>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">Bench Demand @ Intel</td>
                                    <ng-container *ngFor="let data of forecastTableSummaryList">
                                        <td style="min-width:50px">{{data.Bench_Demand_Intel}}</td>
                                    </ng-container>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">Rack Demand @ Intel</td>
                                    <ng-container *ngFor="let data of forecastTableSummaryList">
                                        <td style="min-width:50px">{{data.Rack_Demand_Intel}}</td>
                                    </ng-container>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">Bench Demand @ ODC</td>
                                    <ng-container *ngFor="let data of forecastTableSummaryList">
                                        <td style="min-width:50px">{{data.Bench_Demand_ODC}}</td>
                                    </ng-container>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">Rack Demand @ ODC</td>
                                    <ng-container *ngFor="let data of forecastTableSummaryList">
                                        <td style="min-width:50px">{{data.Rack_Demand_ODC}}</td>
                                    </ng-container>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">Total</td>
                                    <ng-container *ngFor="let data of forecastTableSummaryList">
                                        <td style="min-width:50px">{{data.Total}}</td>
                                    </ng-container>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">Loading % Intel vs ODC -
                                        {{preSelectedForecastTableSummary}}</td>
                                    <td style="min-width:50px;font-weight: bold;">JAN</td>
                                    <td style="min-width:50px;font-weight: bold;">FEB</td>
                                    <td style="min-width:50px;font-weight: bold;">MAR</td>
                                    <td style="min-width:50px;font-weight: bold;">APR</td>
                                    <td style="min-width:50px;font-weight: bold;">MAY</td>
                                    <td style="min-width:50px;font-weight: bold;">JUN</td>
                                    <td style="min-width:50px;font-weight: bold;">JUL</td>
                                    <td style="min-width:50px;font-weight: bold;">AUG</td>
                                    <td style="min-width:50px;font-weight: bold;">SEP</td>
                                    <td style="min-width:50px;font-weight: bold;">OCT</td>
                                    <td style="min-width:50px;font-weight: bold;">NOV</td>
                                    <td style="min-width:50px;font-weight: bold;">DEC</td>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">Intel %</td>
                                    <ng-container *ngFor="let data of forecastTableSummaryList">
                                        <td style="min-width:50px">{{data.Intel_percentage}}</td>
                                    </ng-container>
                                </tr>
                                <tr>
                                    <td style="min-width:50px;font-weight: bold;">ODC % </td>
                                    <ng-container *ngFor="let data of forecastTableSummaryList">
                                        <td style="min-width:50px">{{data.ODC_percentage}}</td>
                                    </ng-container>
                                </tr>
                            </table>
                        </div>
                        <!-- No data available display -->
                        <!--   <div class="no_data_block_display" *ngIf='ChartData?.length == 0'>
                        <h2 class="mt-2">No Data Available</h2>
                    </div> -->
                    </div>
                    <br />
                </div>
            </div>
            <!-- Add new forecast data -->
            <div class="col-12" [hidden]="typeChart != 'Program chart'">

                <div class="btn-add-user" style="float: right; display: flex;">
                    <input #fileInput type="file" style="display: none;"
                        (change)="onFileChange($event);UpdloadForecastDataPopUp(addmodal)" />
                    <a class="download-template" (click)="fileInput.click()">Upload Forecaste Data</a>
                    <a class="download-template" href="/assets/Template/Forecast Data Upload Template.xlsx">Download
                        Template</a>
                    <i class="fa fa-solid fa-plus"
                        style="font-size: 22px;cursor: pointer;color: #9eacb4;margin-right: 10px;margin-top: 5px;"
                        ngbTooltip="Add New Forecast Data" (click)="AddRow()"></i>
                    <!-- <button class="btn add-btn" (click)="AddRow()"> Add New Forecast Data </button> -->
                    <select class="form-select location_select" style="width: 120px;"
                        aria-label="Default select example" [(ngModel)]="preSelectedYearAddForecast"
                        (change)="onItemSelectedAddForecast()">
                        <option selected value="">Select Year</option>
                        <option *ngFor="let locat of addForecastYearList" [ngValue]="locat">
                            {{locat}}
                        </option>
                    </select>
                </div>

                <div class="table-container">
                    <table class="table table-bordered mt-3" *ngIf='tableData?.length'>
                        <thead>
                            <tr>
                                <th colspan="5">
                                    RVP forecast for {{preSelectedYearAddForecast}}
                                </th>
                                <!--   <th>

                                </th>
                                <th>

                                </th>
                                <th>

                                </th>
                                <th>

                                </th> -->
                                <th>
                                    Month
                                </th>
                                <th colspan="4" *ngFor="let column of monthsOfYear">{{ column }}</th>
                                <th>

                                </th>
                            </tr>
                            <tr>
                                <th>
                                    S.No
                                </th>
                                <th>
                                    Program
                                </th>
                                <th>
                                    SKU
                                </th>
                                <th>
                                    Function
                                </th>
                                <th>
                                    Vendor
                                </th>
                                <th>
                                    TOTAL Board Count
                                </th>
                                <th class="text_align_b_t" *ngFor="let column of boardsHeaderColumns">{{ column }}</th>
                                <th>
                                    Action
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let row of tableData; let rowIndex = index">
                                <td>{{rowIndex+1}}</td>
                                <td *ngFor="let cell of row; let colIndex = index">
                                    <ng-container *ngIf="cell.properties == 'Program'">
                                        <div [hidden]="!cell.editing">
                                            <select class="form-select location_select" style="width: 120px;"
                                                aria-label="Default select example" [(ngModel)]="cell.value"
                                                (change)="onChangeProgram(cell.value)"
                                                (blur)="onCellEditDone(rowIndex, colIndex)"
                                                (keydown.enter)="onCellEditDone(rowIndex, colIndex)">
                                                <option selected value="">Select Program</option>
                                                <option *ngFor="let locat of programList?.ProgramName"
                                                    [ngValue]="locat">
                                                    {{locat}}
                                                </option>
                                            </select>
                                        </div>
                                        <div (click)="startEditingCell(rowIndex, colIndex)" [hidden]="cell.editing"
                                            style="width: 120px;">
                                            {{ cell.value }}
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="cell.properties == 'Sku'">
                                        <div [hidden]="!cell.editing">
                                            <select class="form-select location_select" style="width: 120px;"
                                                aria-label="Default select example" [(ngModel)]="cell.value"
                                                (blur)="onCellEditDone(rowIndex, colIndex)"
                                                (keydown.enter)="onCellEditDone(rowIndex, colIndex)">
                                                <option selected value="">Select SKU</option>
                                                <option *ngFor="let locat of skuList" [ngValue]="locat">
                                                    {{locat}}
                                                </option>
                                            </select>
                                        </div>
                                        <div (click)="startEditingCell(rowIndex, colIndex)" [hidden]="cell.editing"
                                            style="width: 120px;">
                                            {{ cell.value }}
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="cell.properties == 'Team'">
                                        <div [hidden]="!cell.editing">
                                            <select class="form-select location_select" style="width: 120px;"
                                                aria-label="Default select example" [(ngModel)]="cell.value"
                                                (blur)="onCellEditDone(rowIndex, colIndex)"
                                                (keydown.enter)="onCellEditDone(rowIndex, colIndex)">
                                                <option selected value="">Select Team</option>
                                                <option *ngFor="let loca of teamList?.TeamName" [ngValue]="loca">
                                                    {{loca}}
                                                </option>
                                            </select>
                                        </div>
                                        <div (click)="startEditingCell(rowIndex, colIndex)" [hidden]="cell.editing"
                                            style="width: 120px;">
                                            {{ cell.value }}
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="cell.properties == 'Vendor'">
                                        <div [hidden]="!cell.editing">
                                            <select class="form-select location_select" style="width: 120px;"
                                                aria-label="Default select example" [(ngModel)]="cell.value"
                                                (blur)="onCellEditDone(rowIndex, colIndex)"
                                                (keydown.enter)="onCellEditDone(rowIndex, colIndex)">
                                                <option selected value="">Select Vendor</option>
                                                <option *ngFor="let locat of vendorList?.Vendors" [ngValue]="locat">
                                                    {{locat}}
                                                </option>
                                            </select>
                                        </div>
                                        <div (click)="startEditingCell(rowIndex, colIndex)" [hidden]="cell.editing"
                                            style="width: 120px;">
                                            {{ cell.value }}
                                        </div>
                                    </ng-container>
                                    <ng-container
                                        *ngIf="cell.properties != 'Program' && cell.properties != 'Sku' && cell.properties != 'Team' && cell.properties != 'Vendor' && cell.properties != 'Action'">
                                        <div [hidden]="!cell.editing">
                                            <input [(ngModel)]="cell.value" (blur)="onCellEditDone(rowIndex, colIndex)"
                                                (keydown.enter)="onCellEditDone(rowIndex, colIndex)"
                                                style="width: 60px;" />
                                        </div>
                                        <div (click)="startEditingCell(rowIndex, colIndex)" [hidden]="cell.editing"
                                            style="width: 60px;">
                                            {{ cell.value }}
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="cell.properties == 'Action'">
                                        <div style="display: flex;">
                                            <span style="cursor: pointer;margin-right:5px"
                                                (click)="AddNewRow(row,rowIndex)"
                                                *ngIf="cell.value == 'Add'">Save</span>
                                            <span style="cursor: pointer;margin-right:5px"
                                                (click)="EditRow(row,rowIndex)"
                                                *ngIf="cell.value == 'Update'">Update</span> |
                                            <span style="cursor: pointer;margin-left:5px"
                                                (click)="DeleteAddRow(rowIndex)"
                                                *ngIf="cell.value == 'Add'">Delete</span>
                                            <span style="cursor: pointer;margin-left:5px"
                                                (click)="DeleteRow(row,rowIndex)"
                                                *ngIf="cell.value == 'Update'">Delete</span>
                                        </div>
                                    </ng-container>
                                </td>
                                <!--   <td>
                                    <div style="display: flex;">
                                        <span style="cursor: pointer;margin-right:5px" (click)="EditRow()">Update</span> |
                                        <span style="cursor: pointer;margin-left:5px" (click)="DeleteRow()">Delete</span>
                                    </div>
                                </td> -->
                            </tr>
                        </tbody>
                    </table>
                    <!-- No data available display -->
                    <div class="no_data_block_display" *ngIf='tableData?.length == 0'>
                        <h2 class="mt-2">No Data Available</h2>
                    </div>
                </div>
            </div>
            <!-- YOY Comparison -->
            <div class="col-12" [hidden]="typeChart != 'YOY Comparison'">

            </div>
        </div>
    </div>
</div>

<!-- loader -->
<div class="overlay-main-lab" *ngIf="!labwiseChartLoader">
    <div class="spinner-container-lab">

        <div class="spinner">
            <div class="rect1"></div>
            <div class="rect2"></div>
            <div class="rect3"></div>
            <div class="rect4"></div>
            <div class="rect5"></div>
            <div class="rect6"></div>
            <div class="rect7"></div>
            <div class="rect8"></div>
            <div class="rect9"></div>
        </div>
        <div class="proccessing-text">Loading ...</div>
    </div>
</div>

<!-- =========***** Modal popup for add platform details*****=============-->
<ng-template #addmodal let-c="close" let-d="dismiss">
    <div class="modal-add">
        <div class="modal-header">
            <h1 class="modal-title fs-5" id="testModalLabel">&nbsp; RVP forecast for {{preSelectedYearAddForecast}}
            </h1>
            <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                <i class='fas fa-times'></i></button>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col-12">
                    <div class="table-container">
                        <table class="table table-bordered mt-3 table_xl_upload_preview">
                            <tbody>
                                <tr *ngFor="let row of data">
                                    <td *ngFor="let val of row">
                                        {{val}}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn back-btn close" aria-label="Close"
                (click)="d('Cross click')">Cancel</button>
            <button type="button" class="btn back-btn" (click)="saveXLData()">Save</button>
        </div>
    </div>
</ng-template>